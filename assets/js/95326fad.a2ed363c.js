"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[63589],{28453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>o});var t=n(96540);const i={},a=t.createContext(i);function r(e){const s=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(a.Provider,{value:s},e.children)}},79049:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"core-concepts/event-system","title":"Event System","description":"Double-buffered event buses with phase/pass propagation for decoupled system communication.","source":"@site/docs/core-concepts/event-system.md","sourceDirName":"core-concepts","slug":"/core-concepts/event-system","permalink":"/docs/core-concepts/event-system","draft":false,"unlisted":false,"editUrl":"https://github.com/thorstensuckow/helios/tree/main/website/docs/core-concepts/event-system.md","tags":[{"inline":true,"label":"gameplay","permalink":"/docs/tags/gameplay"},{"inline":true,"label":"architecture","permalink":"/docs/tags/architecture"},{"inline":true,"label":"events","permalink":"/docs/tags/events"}],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Event System","description":"Double-buffered event buses with phase/pass propagation for decoupled system communication.","slug":"/core-concepts/event-system","sidebar_label":"Event System","sidebar_position":6,"tags":["gameplay","architecture","events"],"keywords":["helios","event system","EventBus","phase","pass","double-buffer","decoupled communication"]}}');var i=n(74848),a=n(28453);const r={title:"Event System",description:"Double-buffered event buses with phase/pass propagation for decoupled system communication.",slug:"/core-concepts/event-system",sidebar_label:"Event System",sidebar_position:6,tags:["gameplay","architecture","events"],keywords:["helios","event system","EventBus","phase","pass","double-buffer","decoupled communication"]},o="Event System",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Event Types",id:"event-types",level:2},{value:"Phase/Pass Architecture",id:"phasepass-architecture",level:2},{value:"Phases",id:"phases",level:3},{value:"Passes",id:"passes",level:3},{value:"Event Buses",id:"event-buses",level:2},{value:"Phase Event Bus",id:"phase-event-bus",level:3},{value:"Pass Event Bus",id:"pass-event-bus",level:3},{value:"Commit Points",id:"commit-points",level:2},{value:"Pass Commit Point",id:"pass-commit-point",level:3},{value:"Phase Commit",id:"phase-commit",level:3},{value:"Event Propagation Summary",id:"event-propagation-summary",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Event Design",id:"event-design",level:3},{value:"Choosing pushPass vs pushPhase",id:"choosing-pushpass-vs-pushphase",level:3},{value:"Event vs Command",id:"event-vs-command",level:3},{value:"Game Loop Integration",id:"game-loop-integration",level:2},{value:"Related Modules",id:"related-modules",level:2}];function h(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"event-system",children:"Event System"})}),"\n",(0,i.jsx)(s.p,{children:"This document describes the event system in helios, including the double-buffered event buses, phase/pass event propagation, and integration with the game loop."}),"\n",(0,i.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(s.p,{children:["The Event System provides a mechanism for ",(0,i.jsx)(s.strong,{children:"decoupled communication"})," between systems. Unlike Commands that mutate world state directly, Events are signals that inform other systems about something that happened or is requested. Events enable loose coupling: the producer doesn't need to know who consumes the event."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                              FRAME N                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    pushPhase()    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502   System A   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502     Phase Event Bus          \u2502   \u2502\n\u2502  \u2502              \u2502                   \u2502  (write buffer)              \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    pushPass()     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502   System B   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502     Pass Event Bus           \u2502   \u2502\n\u2502  \u2502              \u2502                   \u2502  (write buffer)              \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n                              \u2502 Phase/Pass Commit\n                              \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           FRAME N+1 / NEXT PASS                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    readPhase()    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502     Phase Event Bus          \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502   System C   \u2502   \u2502\n\u2502  \u2502  (read buffer)               \u2502                   \u2502              \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    readPass()     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502     Pass Event Bus           \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502   System D   \u2502   \u2502\n\u2502  \u2502  (read buffer)               \u2502                   \u2502              \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(s.h2,{id:"event-types",children:"Event Types"}),"\n",(0,i.jsxs)(s.p,{children:["Events are plain data structs that carry information. They don't have an ",(0,i.jsx)(s.code,{children:"execute()"})," method like Commands."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cpp",children:"struct TriggerCollisionEvent {\n    helios::util::Guid entityA;\n    helios::util::Guid entityB;\n    helios::math::vec3f contactPoint;\n};\n\nstruct SpawnRequestEvent {\n    EnemyType type;\n    helios::math::vec3f position;\n};\n"})}),"\n",(0,i.jsx)(s.h2,{id:"phasepass-architecture",children:"Phase/Pass Architecture"}),"\n",(0,i.jsxs)(s.p,{children:["The helios game loop is organized into ",(0,i.jsx)(s.strong,{children:"Phases"})," and ",(0,i.jsx)(s.strong,{children:"Passes"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                            FRAME                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                     PRE PHASE                               \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u2502    \u2502\n\u2502  \u2502  \u2502 Pass 1  \u2502\u2500\u2500>\u2502 Pass 2  \u2502\u2500\u2500>\u2502 Pass 3  \u2502                    \u2502    \u2502\n\u2502  \u2502  \u2502 (Input) \u2502   \u2502(Commit) \u2502   \u2502(Physics)\u2502                    \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502    \u2502\n\u2502  \u2502                     \u2502                                        \u2502    \u2502\n\u2502  \u2502              Pass Commit Point                               \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                            \u2502                                        \u2502\n\u2502                     Phase Commit                                    \u2502\n\u2502                            \u25bc                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                    MAIN PHASE                               \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u2502    \u2502\n\u2502  \u2502  \u2502 Pass 1  \u2502\u2500\u2500>\u2502 Pass 2  \u2502\u2500\u2500>\u2502 Pass 3  \u2502                    \u2502    \u2502\n\u2502  \u2502  \u2502(Gameplay\u2502   \u2502(Collision\u2502  \u2502 (AI)   \u2502                    \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                            \u2502                                        \u2502\n\u2502                     Phase Commit                                    \u2502\n\u2502                            \u25bc                                        \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502                    POST PHASE                               \u2502    \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                  \u2502    \u2502\n\u2502  \u2502  \u2502 Pass 1  \u2502\u2500\u2500>\u2502 Pass 2  \u2502                                  \u2502    \u2502\n\u2502  \u2502  \u2502 (Sync)  \u2502   \u2502(Cleanup)\u2502                                  \u2502    \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                  \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                            \u2502                                        \u2502\n\u2502                     Phase Commit                                    \u2502\n\u2502                            \u25bc                                        \u2502\n\u2502                        RENDER                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(s.h3,{id:"phases",children:"Phases"}),"\n",(0,i.jsxs)(s.p,{children:["A ",(0,i.jsx)(s.strong,{children:"Phase"})," is a major segment of the game loop with a specific purpose:"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Phase"}),(0,i.jsx)(s.th,{children:"Purpose"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Pre"})}),(0,i.jsx)(s.td,{children:"Input processing, event dispatch, command execution"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Main"})}),(0,i.jsx)(s.td,{children:"Core gameplay: physics, AI, collision, gameplay systems"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:(0,i.jsx)(s.strong,{children:"Post"})}),(0,i.jsx)(s.td,{children:"Scene synchronization, cleanup, state reset"})]})]})]}),"\n",(0,i.jsxs)(s.p,{children:["After each phase completes, a ",(0,i.jsx)(s.strong,{children:"Phase Commit"})," occurs:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Phase event bus is swapped (events become readable in next phase)"}),"\n",(0,i.jsx)(s.li,{children:"Pass event bus is cleared"}),"\n",(0,i.jsx)(s.li,{children:"CommandBuffer is flushed"}),"\n",(0,i.jsx)(s.li,{children:"Managers are flushed"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"passes",children:"Passes"}),"\n",(0,i.jsxs)(s.p,{children:["A ",(0,i.jsx)(s.strong,{children:"Pass"})," is a sub-unit within a phase containing one or more systems. Passes execute sequentially within their phase."]}),"\n",(0,i.jsxs)(s.p,{children:["A pass can optionally have a ",(0,i.jsx)(s.strong,{children:"Commit Point"}),". When a pass has a commit point:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"The pass event bus is swapped after the pass completes"}),"\n",(0,i.jsxs)(s.li,{children:["Events pushed via ",(0,i.jsx)(s.code,{children:"pushPass()"})," become readable in subsequent passes via ",(0,i.jsx)(s.code,{children:"readPass()"})]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"event-buses",children:"Event Buses"}),"\n",(0,i.jsx)(s.h3,{id:"phase-event-bus",children:"Phase Event Bus"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.strong,{children:"Phase Event Bus"})," enables communication across phase boundaries."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cpp",children:"// In Pre Phase - System pushes an event\nupdateContext.pushPhase<SpawnRequestEvent>(EnemyType::Grunt, position);\n\n// In Main Phase - System reads events from previous phase\nfor (const auto& evt : updateContext.readPhase<SpawnRequestEvent>()) {\n    spawnManager.queueSpawn(evt.type, evt.position);\n}\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Lifecycle:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Events pushed via ",(0,i.jsx)(s.code,{children:"pushPhase()"})," are written to the write buffer"]}),"\n",(0,i.jsx)(s.li,{children:"At Phase Commit, buffers are swapped"}),"\n",(0,i.jsxs)(s.li,{children:["Events become readable via ",(0,i.jsx)(s.code,{children:"readPhase()"})," in the next phase"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Pass-level events do NOT propagate to the next phase"})," (cleared at phase commit)"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"pass-event-bus",children:"Pass Event Bus"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.strong,{children:"Pass Event Bus"})," enables communication within a phase, across passes."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cpp",children:"// In Pass 1 - Collision system pushes event\nupdateContext.pushPass<TriggerCollisionEvent>(entityA, entityB, contact);\n\n// Pass 1 ends with commit point\n\n// In Pass 2 - Response system reads events\nfor (const auto& evt : updateContext.readPass<TriggerCollisionEvent>()) {\n    // React to collision\n}\n"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Lifecycle:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Events pushed via ",(0,i.jsx)(s.code,{children:"pushPass()"})," are written to the write buffer"]}),"\n",(0,i.jsx)(s.li,{children:"At Pass Commit (if pass has commit point), buffers are swapped"}),"\n",(0,i.jsxs)(s.li,{children:["Events become readable via ",(0,i.jsx)(s.code,{children:"readPass()"})," in subsequent passes"]}),"\n",(0,i.jsx)(s.li,{children:"All pass events are cleared at the next Phase Commit"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"commit-points",children:"Commit Points"}),"\n",(0,i.jsx)(s.h3,{id:"pass-commit-point",children:"Pass Commit Point"}),"\n",(0,i.jsx)(s.p,{children:"A pass can be configured with a commit point:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cpp",children:"auto& mainPhase = gameLoop.phase(PhaseType::Main);\n\n// Add a pass with a commit point\nmainPhase.addPass()\n    .addSystem<CollisionSystem>(gameWorld)\n    .addCommitPoint();  // Events from this pass become readable\n\nmainPhase.addPass()\n    .addSystem<CollisionResponseSystem>(gameWorld);  // Can read collision events\n"})}),"\n",(0,i.jsx)(s.h3,{id:"phase-commit",children:"Phase Commit"}),"\n",(0,i.jsx)(s.p,{children:"Phase commit happens automatically after each phase and performs:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cpp",children:"void phaseCommit(GameWorld& gameWorld, UpdateContext& updateContext) {\n    // 1. Swap phase event bus - events become readable in next phase\n    phaseEventBus_.swapBuffers();\n    \n    // 2. Clear pass event bus - pass events don't cross phases\n    passEventBus_.clearAll();\n    \n    // 3. Flush commands\n    commandBuffer_.flush(updateContext.gameWorld());\n    \n    // 4. Flush managers\n    gameWorld.flushManagers(updateContext);\n}\n"})}),"\n",(0,i.jsx)(s.h2,{id:"event-propagation-summary",children:"Event Propagation Summary"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     EVENT VISIBILITY RULES                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                     \u2502\n\u2502  pushPass() events:                                                 \u2502\n\u2502    \u251c\u2500\u2500 Visible in subsequent passes (after commit point)            \u2502\n\u2502    \u251c\u2500\u2500 Within the SAME phase only                                   \u2502\n\u2502    \u2514\u2500\u2500 Cleared at phase boundary                                    \u2502\n\u2502                                                                     \u2502\n\u2502  pushPhase() events:                                                \u2502\n\u2502    \u251c\u2500\u2500 Visible in the NEXT phase                                    \u2502\n\u2502    \u251c\u2500\u2500 NOT visible in the same phase                                \u2502\n\u2502    \u2514\u2500\u2500 Cleared after being read (next phase commit)                 \u2502\n\u2502                                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(s.h3,{id:"event-design",children:"Event Design"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Events should be ",(0,i.jsx)(s.strong,{children:"immutable"})," data structs"]}),"\n",(0,i.jsxs)(s.li,{children:["Keep events ",(0,i.jsx)(s.strong,{children:"lightweight"})," \u2014 store only essential data (IDs, not full objects)"]}),"\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.strong,{children:"value types"})," rather than pointers in events"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"choosing-pushpass-vs-pushphase",children:"Choosing pushPass vs pushPhase"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsxs)(s.th,{children:["Use ",(0,i.jsx)(s.code,{children:"pushPass()"})," when..."]}),(0,i.jsxs)(s.th,{children:["Use ",(0,i.jsx)(s.code,{children:"pushPhase()"})," when..."]})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Event needs same-phase processing"}),(0,i.jsx)(s.td,{children:"Event triggers next-phase logic"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Collision \u2192 Response within Main phase"}),(0,i.jsx)(s.td,{children:"Spawn request \u2192 Command generation"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Tight coupling within a phase"}),(0,i.jsx)(s.td,{children:"Loose coupling across phases"})]})]})]}),"\n",(0,i.jsx)(s.h3,{id:"event-vs-command",children:"Event vs Command"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Aspect"}),(0,i.jsx)(s.th,{children:"Event"}),(0,i.jsx)(s.th,{children:"Command"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Purpose"}),(0,i.jsx)(s.td,{children:"Signal/notification"}),(0,i.jsx)(s.td,{children:"World mutation"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Has execute()?"}),(0,i.jsx)(s.td,{children:"No"}),(0,i.jsx)(s.td,{children:"Yes"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Timing"}),(0,i.jsx)(s.td,{children:"Deferred (buffered)"}),(0,i.jsx)(s.td,{children:"Deferred (buffered)"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Producer knows consumer?"}),(0,i.jsx)(s.td,{children:"No"}),(0,i.jsx)(s.td,{children:"No (with dispatchers)"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"game-loop-integration",children:"Game Loop Integration"}),"\n",(0,i.jsx)(s.p,{children:"Full frame execution order:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cpp",children:"for (phase : {Pre, Main, Post}) {\n    \n    for (pass : phase.passes()) {\n        \n        for (system : pass.systems()) {\n            system.update(updateContext);\n            // Systems can:\n            // - pushPass<E>() for same-phase communication\n            // - pushPhase<E>() for next-phase communication\n            // - readPass<E>() for events from previous passes\n            // - readPhase<E>() for events from previous phase\n        }\n        \n        if (pass.hasCommitPoint()) {\n            passEventBus.swapBuffers();  // Pass events become readable\n        }\n    }\n    \n    // Phase Commit\n    phaseEventBus.swapBuffers();    // Phase events become readable\n    passEventBus.clearAll();         // Clear pass events\n    commandBuffer.flush();           // Execute commands\n    gameWorld.flushManagers();       // Process manager queues\n}\n"})}),"\n",(0,i.jsx)(s.h2,{id:"related-modules",children:"Related Modules"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"helios.engine.runtime.messaging.event.GameLoopEventBus"})," \u2014 Double-buffered event bus"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"helios.engine.runtime.world.UpdateContext"})," \u2014 Event push/read methods"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"helios.engine.runtime.gameloop.GameLoop"})," \u2014 Phase/pass orchestration"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"helios.engine.runtime.gameloop.Phase"})," \u2014 Phase container"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"helios.engine.runtime.gameloop.Pass"})," \u2014 Pass container with optional commit point"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"helios.core.buffer.TypeIndexedDoubleBuffer"})," \u2014 Underlying buffer implementation"]}),"\n"]})]})}function c(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);