"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[27865],{17760:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"core-concepts/ecs/entity-handle","title":"EntityHandle","description":"Lightweight versioned reference for safe entity identification.","source":"@site/docs/core-concepts/ecs/entity-handle.md","sourceDirName":"core-concepts/ecs","slug":"/core-concepts/ecs/entity-handle","permalink":"/docs/core-concepts/ecs/entity-handle","draft":false,"unlisted":false,"editUrl":"https://github.com/thorstensuckow/helios/tree/main/website/docs/core-concepts/ecs/entity-handle.md","tags":[{"inline":true,"label":"ecs","permalink":"/docs/tags/ecs"},{"inline":true,"label":"architecture","permalink":"/docs/tags/architecture"},{"inline":true,"label":"handle","permalink":"/docs/tags/handle"}],"version":"current","sidebarPosition":4,"frontMatter":{"title":"EntityHandle","description":"Lightweight versioned reference for safe entity identification.","slug":"/core-concepts/ecs/entity-handle","sidebar_label":"EntityHandle","sidebar_position":4,"tags":["ecs","architecture","handle"],"keywords":["helios","EntityHandle","ECS","versioned reference","stale detection"]},"sidebar":"tutorialSidebar","previous":{"title":"EntityRegistry","permalink":"/docs/core-concepts/ecs/entity-registry"},"next":{"title":"View","permalink":"/docs/core-concepts/ecs/view"}}');var s=i(74848),r=i(28453);const l={title:"EntityHandle",description:"Lightweight versioned reference for safe entity identification.",slug:"/core-concepts/ecs/entity-handle",sidebar_label:"EntityHandle",sidebar_position:4,tags:["ecs","architecture","handle"],keywords:["helios","EntityHandle","ECS","versioned reference","stale detection"]},c="EntityHandle",d={},a=[{value:"Overview",id:"overview",level:2},{value:"Versioned References",id:"versioned-references",level:2},{value:"API Reference",id:"api-reference",level:2},{value:"Construction",id:"construction",level:3},{value:"Comparison",id:"comparison",level:3},{value:"Validity Check",id:"validity-check",level:3},{value:"Hashing",id:"hashing",level:3},{value:"Memory Layout",id:"memory-layout",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"entityhandle",children:"EntityHandle"})}),"\n",(0,s.jsxs)(n.p,{children:["An ",(0,s.jsx)(n.strong,{children:"EntityHandle"})," is a lightweight, versioned reference to an entity in the ECS. It combines an entity ID with a version number to provide safe references that can detect stale (deleted) entities."]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"struct EntityHandle {\n    EntityId entityId;   // Unique identifier within the pool\n    VersionId versionId; // Version for stale detection\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:"The handle is designed to be:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lightweight"})," - Only 8 bytes (two 32-bit integers)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Copyable"})," - Safe to pass by value"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Hashable"})," - Can be used as a key in ",(0,s.jsx)(n.code,{children:"std::unordered_map"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Comparable"})," - Supports equality and ordering operators"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"versioned-references",children:"Versioned References"}),"\n",(0,s.jsxs)(n.p,{children:["The version number solves the ",(0,s.jsx)(n.strong,{children:"ABA problem"})," in entity systems:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Entity A is created at index 5 with version 1"}),"\n",(0,s.jsx)(n.li,{children:"Entity A is destroyed - index 5 is recycled, version becomes 2"}),"\n",(0,s.jsx)(n.li,{children:"Entity B is created at index 5 with version 2"}),"\n",(0,s.jsxs)(n.li,{children:["Old handles to Entity A (index 5, version 1) are now ",(0,s.jsx)(n.strong,{children:"stale"})]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"EntityRegistry registry;\n\nauto handleA = registry.create();  // {entityId: 5, versionId: 1}\nregistry.destroy(handleA);\n\nauto handleB = registry.create();  // {entityId: 5, versionId: 2}\n\n// handleA is now stale - same index, different version\nassert(!registry.isValid(handleA));  // false\nassert(registry.isValid(handleB));   // true\n"})}),"\n",(0,s.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,s.jsx)(n.h3,{id:"construction",children:"Construction"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"// Default constructor (invalid handle)\nEntityHandle handle;\n\n// Explicit construction\nEntityHandle handle{entityId, versionId};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"comparison",children:"Comparison"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"EntityHandle a{1, 1};\nEntityHandle b{1, 1};\nEntityHandle c{2, 1};\n\na == b;  // true - same entity ID and version\na == c;  // false - different entity ID\na < c;   // true - compares by entity ID\n"})}),"\n",(0,s.jsx)(n.h3,{id:"validity-check",children:"Validity Check"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"EntityHandle handle{5, 1};\nhandle.isValid();  // true (version >= 1)\n\nEntityHandle invalid{};\ninvalid.isValid();  // false (default version is 0)\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," ",(0,s.jsx)(n.code,{children:"isValid()"})," only checks if the handle ",(0,s.jsx)(n.em,{children:"could"})," be valid (version >= 1). To check if the entity actually exists, use ",(0,s.jsx)(n.code,{children:"EntityRegistry::isValid()"})," or ",(0,s.jsx)(n.code,{children:"EntityManager::isValid()"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"hashing",children:"Hashing"}),"\n",(0,s.jsxs)(n.p,{children:["EntityHandle provides a ",(0,s.jsx)(n.code,{children:"std::hash"})," specialization for use in hash-based containers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'std::unordered_map<EntityHandle, std::string> entityNames;\nentityNames[handle] = "Player";\n\nstd::unordered_set<EntityHandle> selectedEntities;\nselectedEntities.insert(handle);\n'})}),"\n",(0,s.jsx)(n.h2,{id:"memory-layout",children:"Memory Layout"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           EntityHandle              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502    entityId      \u2502    versionId     \u2502\n\u2502    (32 bits)     \u2502    (32 bits)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         Total: 8 bytes\n"})}),"\n",(0,s.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Store handles, not pointers"})," - Handles survive entity recycling detection"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Validate before use"})," - Always check ",(0,s.jsx)(n.code,{children:"registry.isValid(handle)"})," before accessing components"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Pass by value"})," - Handles are small enough to copy efficiently"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Don't rely on ordering"})," - Entity IDs may be recycled in any order"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/core-concepts/ecs/entity-registry",children:"EntityRegistry"})," - Handle allocation and validation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/core-concepts/ecs/entity-manager",children:"EntityManager"})," - Component storage"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/core-concepts/ecs/gameobject",children:"GameObject"})," - High-level entity wrapper"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var t=i(96540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);