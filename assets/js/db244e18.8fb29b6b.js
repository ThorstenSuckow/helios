"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[22889],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var a=n(96540);const s={},i=a.createContext(s);function r(e){const t=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:t},e.children)}},97259:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"core-concepts/state-management","title":"State Management","description":"Rule-based state machines for game and match state transitions with listeners and command-driven changes.","source":"@site/docs/core-concepts/state-management.md","sourceDirName":"core-concepts","slug":"/core-concepts/state-management","permalink":"/docs/core-concepts/state-management","draft":false,"unlisted":false,"editUrl":"https://github.com/thorstensuckow/helios/tree/main/website/docs/core-concepts/state-management.md","tags":[{"inline":true,"label":"gameplay","permalink":"/docs/tags/gameplay"},{"inline":true,"label":"architecture","permalink":"/docs/tags/architecture"},{"inline":true,"label":"state","permalink":"/docs/tags/state"}],"version":"current","sidebarPosition":13,"frontMatter":{"title":"State Management","description":"Rule-based state machines for game and match state transitions with listeners and command-driven changes.","slug":"/core-concepts/state-management","sidebar_label":"State Management","sidebar_position":13,"tags":["gameplay","architecture","state"],"keywords":["helios","state management","GameState","MatchState","state machine","transitions"]},"sidebar":"tutorialSidebar","previous":{"title":"Game Loop","permalink":"/docs/core-concepts/gameloop-architecture"},"next":{"title":"GameObject Builder","permalink":"/docs/core-concepts/gameobject-builder"}}');var s=n(74848),i=n(28453);const r={title:"State Management",description:"Rule-based state machines for game and match state transitions with listeners and command-driven changes.",slug:"/core-concepts/state-management",sidebar_label:"State Management",sidebar_position:13,tags:["gameplay","architecture","state"],keywords:["helios","state management","GameState","MatchState","state machine","transitions"]},l="State Management",c={},o=[{value:"Overview",id:"overview",level:2},{value:"Example State Configurations",id:"example-state-configurations",level:3},{value:"Hierarchical State Machine",id:"hierarchical-state-machine",level:2},{value:"Key Concepts",id:"key-concepts",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Session State Registration",id:"session-state-registration",level:2},{value:"Type Trait Specialization",id:"type-trait-specialization",level:2},{value:"Transition Flow",id:"transition-flow",level:2},{value:"Transition Rules",id:"transition-rules",level:2},{value:"Guarded Transitions",id:"guarded-transitions",level:3},{value:"Listeners",id:"listeners",level:2},{value:"Interface",id:"interface",level:3},{value:"Lambda-based Listener",id:"lambda-based-listener",level:3},{value:"Usage Example",id:"usage-example",level:2},{value:"Creating State Managers",id:"creating-state-managers",level:3},{value:"Requesting State Transitions",id:"requesting-state-transitions",level:3},{value:"Querying Current State",id:"querying-current-state",level:3},{value:"State-to-ID Mapping",id:"state-to-id-mapping",level:2},{value:"Pass-Level State Filtering",id:"pass-level-state-filtering",level:2},{value:"Related Topics",id:"related-topics",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"state-management",children:"State Management"})}),"\n",(0,s.jsx)(t.p,{children:"helios provides a generic, template-based state machine architecture for managing application and gameplay states. The system is fully parameterized by state type, enabling reuse for different state enums (e.g., GameState, MatchState)."}),"\n",(0,s.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(t.p,{children:"The state management system uses a common architectural pattern for all state types:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Component"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"StateManager<StateType>"})}),(0,s.jsx)(t.td,{children:"Rule-based state machine with listener support"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"StateTransitionRule<StateType>"})}),(0,s.jsx)(t.td,{children:"Defines valid transitions with optional guards"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"StateTransitionListener<StateType>"})}),(0,s.jsx)(t.td,{children:"Interface for transition observers"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"StateCommand<StateType>"})}),(0,s.jsx)(t.td,{children:"Command for requesting transitions"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"StateComponent<StateType>"})}),(0,s.jsx)(t.td,{children:"Stores current state on entities"})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"example-state-configurations",children:"Example State Configurations"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"State Type"}),(0,s.jsx)(t.th,{children:"Scope"}),(0,s.jsx)(t.th,{children:"Example States"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"GameState"})}),(0,s.jsx)(t.td,{children:"Application lifecycle"}),(0,s.jsx)(t.td,{children:"Title, Running, Paused"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"MatchState"})}),(0,s.jsx)(t.td,{children:"Match/round lifecycle"}),(0,s.jsx)(t.td,{children:"Warmup, PlayerSpawn, Playing"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"hierarchical-state-machine",children:"Hierarchical State Machine"}),"\n",(0,s.jsx)(t.p,{children:"helios supports hierarchical state management where lower-level states (e.g., MatchState) only apply within specific higher-level states (e.g., GameState::Running):"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         GameState                                   \u2502\n\u2502                                                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      StartRequested      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  Title   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba \u2502        Running           \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                          \u2502                          \u2502 \u2502\n\u2502       \u25b2                                \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502    MatchState      \u2502  \u2502 \u2502\n\u2502       \u2502 ReturnToTitle                  \u2502  \u2502                    \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u2502Warmup  \u2502         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502     \u2502 PlayerSpawn  \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502     \u25bc              \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u2502Spawning\u2502         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502     \u2502 StartMatch   \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502     \u25bc              \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u2502Playing \u2502         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518         \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502     \u2502 GameOver     \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502     \u25bc              \u2502  \u2502 \u2502\n\u2502       \u2502                                \u2502  \u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502  \u2502 \u2502\n\u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u253c\u2500\u2502GameOver\u2502         \u2502  \u2502 \u2502\n\u2502                                        \u2502  \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502  \u2502 \u2502\n\u2502                                        \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502                                        \u2502                          \u2502 \u2502\n\u2502                                        \u2502      TogglePause         \u2502 \u2502\n\u2502                                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                     \u2502               \u2502\n\u2502                                                     \u25bc               \u2502\n\u2502                                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502                                        \u2502        Paused          \u2502   \u2502\n\u2502                                        \u2502  (MatchState frozen)   \u2502   \u2502\n\u2502                                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                     \u2502               \u2502\n\u2502                                               TogglePause           \u2502\n\u2502                                                     \u2502               \u2502\n\u2502                                                     \u25bc               \u2502\n\u2502                                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502                                        \u2502        Running         \u2502   \u2502\n\u2502                                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(t.h3,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"GameState"})," is the top-level state controlling application lifecycle"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"MatchState"})," is a nested state that only progresses while ",(0,s.jsx)(t.code,{children:"GameState::Running"})]}),"\n",(0,s.jsxs)(t.li,{children:["When ",(0,s.jsx)(t.code,{children:"GameState"})," transitions to ",(0,s.jsx)(t.code,{children:"Paused"}),", the ",(0,s.jsx)(t.code,{children:"MatchState"})," is frozen"]}),"\n",(0,s.jsxs)(t.li,{children:["Transitions between states are triggered by ",(0,s.jsx)(t.code,{children:"StateCommand<T>"})]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       Session                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502  \u2502 StateComponent<GS>  \u2502    \u2502 StateComponent<MS>  \u2502         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u25b2                           \u25b2\n         \u2502                           \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 StateManager<GS>  \u2502       \u2502 StateManager<MS>  \u2502\n\u2502  - rules[]        \u2502       \u2502  - rules[]        \u2502\n\u2502  - listeners[]    \u2502       \u2502  - listeners[]    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u25b2                           \u25b2\n         \u2502                           \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 StateCommand<GS>  \u2502       \u2502 StateCommand<MS>  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(t.h2,{id:"session-state-registration",children:"Session State Registration"}),"\n",(0,s.jsxs)(t.p,{children:["Before using any state type with the state management system, it must be explicitly registered with the Session via ",(0,s.jsx)(t.code,{children:"trackState<T>()"}),". This adds the corresponding ",(0,s.jsx)(t.code,{children:"StateComponent<T>"})," to the session entity, enabling systems to read and write the state."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"auto& session = gameWorld.session();\n\n// Register state types before use\nsession.trackState<GameState>();\nsession.trackState<MatchState>();\n"})}),"\n",(0,s.jsx)(t.p,{children:"Explicit registration avoids hard-coded state types in the Session class. It enables custom state types without modifying engine code and ensures that StateComponent exists before StateManager attempts to update it. Furthermore, it makes state dependencies visible at initialization time."}),"\n",(0,s.jsx)(t.h2,{id:"type-trait-specialization",children:"Type Trait Specialization"}),"\n",(0,s.jsxs)(t.p,{children:["To use ",(0,s.jsx)(t.code,{children:"StateManager<YourState>"}),", you must specialize ",(0,s.jsx)(t.code,{children:"StateTransitionId"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"// In your bindings module:\ntemplate<>\nstruct helios::engine::state::types::StateTransitionId<GameState> {\n    using Type = GameStateTransitionId;\n};\n\ntemplate<>\nstruct helios::engine::state::types::StateTransitionId<MatchState> {\n    using Type = MatchStateTransitionId;\n};\n"})}),"\n",(0,s.jsx)(t.h2,{id:"transition-flow",children:"Transition Flow"}),"\n",(0,s.jsx)(t.p,{children:"When a state transition is requested:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"StateCommand<T>"})," is submitted to the command buffer"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"StateCommandDispatcher<T>"})," routes it to the registered ",(0,s.jsx)(t.code,{children:"StateManager<T>"})]}),"\n",(0,s.jsxs)(t.li,{children:["During ",(0,s.jsx)(t.code,{children:"flush()"}),", the manager processes pending commands"]}),"\n",(0,s.jsx)(t.li,{children:"Matching rule is found and guard is evaluated (if present)"}),"\n",(0,s.jsxs)(t.li,{children:["Listeners are notified in order:\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"onStateExit(from)"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"onStateTransition(context)"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"onStateEnter(to)"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["Session state is updated via ",(0,s.jsx)(t.code,{children:"StateComponent<T>"})]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"transition-rules",children:"Transition Rules"}),"\n",(0,s.jsx)(t.p,{children:"Rules define valid state changes with optional guards:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"using namespace helios::engine::state::types;\n\n// Define rules as constexpr array\nconstexpr StateTransitionRule<GameState> gameStateRules[] = {\n    // from, transitionId, to\n    {GameState::Title, GameStateTransitionId::StartRequested, GameState::Running},\n    {GameState::Running, GameStateTransitionId::TogglePause, GameState::Paused},\n    {GameState::Paused, GameStateTransitionId::TogglePause, GameState::Running},\n};\n"})}),"\n",(0,s.jsx)(t.h3,{id:"guarded-transitions",children:"Guarded Transitions"}),"\n",(0,s.jsx)(t.p,{children:"Guards are function pointers that can block a transition:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"// Guard callback type: bool(*)(UpdateContext&, const StateTransitionRequest<T>)\nconstexpr StateTransitionRule<GameState> guardedRule{\n    GameState::Running,\n    GameStateTransitionId::GameOver,\n    GameState::Title,\n    // Guard: only allow if player has no lives\n    [](auto& ctx, auto& req) {\n        return ctx.session().lives() == 0;\n    }\n};\n"})}),"\n",(0,s.jsx)(t.h2,{id:"listeners",children:"Listeners"}),"\n",(0,s.jsx)(t.p,{children:"Listeners observe state transitions and perform side effects:"}),"\n",(0,s.jsx)(t.h3,{id:"interface",children:"Interface"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"template<typename StateType>\nclass StateTransitionListener {\npublic:\n    virtual void onStateExit(UpdateContext& ctx, StateType from) = 0;\n    virtual void onStateTransition(UpdateContext& ctx, StateTransitionContext<StateType> transitionCtx) = 0;\n    virtual void onStateEnter(UpdateContext& ctx, StateType to) = 0;\n};\n"})}),"\n",(0,s.jsx)(t.h3,{id:"lambda-based-listener",children:"Lambda-based Listener"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"using namespace helios::engine::state::listeners;\n\nauto listener = std::make_unique<LambdaStateListener<GameState>>(\n    // onExit\n    [](auto& ctx, GameState from) {\n        if (from == GameState::Running) {\n            // Clean up running state\n        }\n    },\n    // onTransition\n    [](auto& ctx, auto transitionCtx) {\n        // Log transition\n    },\n    // onEnter\n    [](auto& ctx, GameState to) {\n        if (to == GameState::Running) {\n            ctx.gameWorld().reset();\n        }\n    }\n);\n\nstateManager->addStateListener(std::move(listener));\n"})}),"\n",(0,s.jsx)(t.h2,{id:"usage-example",children:"Usage Example"}),"\n",(0,s.jsx)(t.h3,{id:"creating-state-managers",children:"Creating State Managers"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"using namespace helios::engine::state;\n\n// Register state types with session (required before managers are flushed)\nauto& session = gameWorld.session();\nsession.trackState<GameState>();\nsession.trackState<MatchState>();\n\n// Create managers with rules\nauto gameStateManager = std::make_unique<StateManager<GameState>>(gameStateRules);\nauto matchStateManager = std::make_unique<StateManager<MatchState>>(matchStateRules);\n\n// Add listeners\ngameStateManager->addStateListener(std::make_unique<LambdaStateListener<GameState>>(\n    /* callbacks */\n));\n\n// Register with GameLoop (managers are initialized and flushed automatically)\ngameLoop.addManager(std::move(gameStateManager));\ngameLoop.addManager(std::move(matchStateManager));\n"})}),"\n",(0,s.jsx)(t.h3,{id:"requesting-state-transitions",children:"Requesting State Transitions"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"using namespace helios::engine::state::commands;\nusing namespace helios::engine::state::types;\n\n// Request game start\nupdateContext.commandBuffer().add<StateCommand<GameState>>(\n    StateTransitionRequest<GameState>{\n        GameState::Title,\n        GameStateTransitionId::StartRequested\n    }\n);\n\n// Request player spawn in match\nupdateContext.commandBuffer().add<StateCommand<MatchState>>(\n    StateTransitionRequest<MatchState>{\n        MatchState::Warmup,\n        MatchStateTransitionId::PlayerSpawnRequested\n    }\n);\n"})}),"\n",(0,s.jsx)(t.h3,{id:"querying-current-state",children:"Querying Current State"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"auto& session = gameWorld.session();\n\nGameState gameState = session.state<GameState>();\nMatchState matchState = session.state<MatchState>();\n\nif (gameState == GameState::Running && matchState == MatchState::Playing) {\n    // Game is actively playing\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"state-to-id-mapping",children:"State-to-ID Mapping"}),"\n",(0,s.jsx)(t.p,{children:"For associating viewports or menus with states, use the mapping utilities:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:'using namespace helios::engine::state;\n\nCombinedStateToIdMapPair<GameState, MatchState, ViewportId> viewportPolicy;\n\n// Map state combinations to viewport IDs\nviewportPolicy.add(GameState::Running, MatchState::Playing, ViewportId("game"));\nviewportPolicy.add(GameState::Paused, MatchState::Undefined, ViewportId("pause_menu"));\nviewportPolicy.add(GameState::Running, MatchState::GameOver, ViewportId("game_over"));\n\nviewportPolicy.freeze();\n\n// Query active viewports for current state\nauto viewportIds = viewportPolicy.ids(gameState, matchState);\n'})}),"\n",(0,s.jsx)(t.h2,{id:"pass-level-state-filtering",children:"Pass-Level State Filtering"}),"\n",(0,s.jsx)(t.p,{children:"Passes in the game loop can be configured to run only during specific states:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-cpp",children:"// This pass only runs when game is Running\ngameLoop.phase(PhaseType::Main)\n    .addPass(GameState::Running)\n        .addSystem<MovementSystem>()\n        .addSystem<CollisionSystem>();\n\n// This pass runs in all states\ngameLoop.phase(PhaseType::Pre)\n    .addPass(GameState::Any)\n        .addSystem<InputSystem>();\n"})}),"\n",(0,s.jsx)(t.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/core-concepts/gameloop-architecture",children:"Game Loop Architecture"})," - Phase/Pass structure"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/core-concepts/command-system",children:"Command System"})," - Command-driven state changes"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/docs/core-concepts/event-system",children:"Event System"})," - Event propagation"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);