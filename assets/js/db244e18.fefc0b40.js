"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[22889],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var a=t(96540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},97259:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"core-concepts/state-management","title":"State Management","description":"Rule-based state machines for game and match state transitions with listeners and command-driven changes.","source":"@site/docs/core-concepts/state-management.md","sourceDirName":"core-concepts","slug":"/core-concepts/state-management","permalink":"/docs/core-concepts/state-management","draft":false,"unlisted":false,"editUrl":"https://github.com/thorstensuckow/helios/tree/main/website/docs/core-concepts/state-management.md","tags":[{"inline":true,"label":"gameplay","permalink":"/docs/tags/gameplay"},{"inline":true,"label":"architecture","permalink":"/docs/tags/architecture"},{"inline":true,"label":"state","permalink":"/docs/tags/state"}],"version":"current","sidebarPosition":13,"frontMatter":{"title":"State Management","description":"Rule-based state machines for game and match state transitions with listeners and command-driven changes.","slug":"/core-concepts/state-management","sidebar_label":"State Management","sidebar_position":13,"tags":["gameplay","architecture","state"],"keywords":["helios","state management","GameState","MatchState","state machine","transitions"]},"sidebar":"tutorialSidebar","previous":{"title":"Game Loop","permalink":"/docs/core-concepts/gameloop-architecture"},"next":{"title":"GameObject Builder","permalink":"/docs/core-concepts/gameobject-builder"}}');var s=t(74848),i=t(28453);const r={title:"State Management",description:"Rule-based state machines for game and match state transitions with listeners and command-driven changes.",slug:"/core-concepts/state-management",sidebar_label:"State Management",sidebar_position:13,tags:["gameplay","architecture","state"],keywords:["helios","state management","GameState","MatchState","state machine","transitions"]},l="Game and Match State Management",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Game State Flow",id:"game-state-flow",level:2},{value:"GameState Enum",id:"gamestate-enum",level:3},{value:"Match State Flow",id:"match-state-flow",level:2},{value:"MatchState Enum",id:"matchstate-enum",level:3},{value:"Transition Rules",id:"transition-rules",level:2},{value:"Listeners",id:"listeners",level:2},{value:"Usage Example",id:"usage-example",level:2},{value:"Configuring State Managers",id:"configuring-state-managers",level:3},{value:"Requesting State Transitions",id:"requesting-state-transitions",level:3},{value:"Querying Current State",id:"querying-current-state",level:3},{value:"Pass-Level State Filtering",id:"pass-level-state-filtering",level:2},{value:"Related Topics",id:"related-topics",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"game-and-match-state-management",children:"Game and Match State Management"})}),"\n",(0,s.jsxs)(n.p,{children:["helios provides a rule-based state machine architecture for managing both ",(0,s.jsx)(n.strong,{children:"Game States"})," (application-level states like Title, Running, Paused) and ",(0,s.jsx)(n.strong,{children:"Match States"})," (gameplay-level states like Warmup, PlayerSpawn, Playing)."]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"The state management system consists of two parallel managers:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Manager"}),(0,s.jsx)(n.th,{children:"Scope"}),(0,s.jsx)(n.th,{children:"Example States"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"GameStateManager"})}),(0,s.jsx)(n.td,{children:"Application lifecycle"}),(0,s.jsx)(n.td,{children:"Title, Running, Paused"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"MatchStateManager"})}),(0,s.jsx)(n.td,{children:"Match/round lifecycle"}),(0,s.jsx)(n.td,{children:"Warmup, PlayerSpawn, Playing"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Both managers share the same architectural pattern:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rule-based transitions"})," with optional guards"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Listener notifications"})," on state changes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Command-driven"})," state changes via ",(0,s.jsx)(n.code,{children:"CommandBuffer"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Session integration"})," for centralized state storage"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       Session                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502  \u2502 GameStateComponent\u2502      \u2502MatchStateComponent\u2502           \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u25b2                           \u25b2\n         \u2502                           \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 GameStateManager\u2502         \u2502MatchStateManager\u2502\n\u2502  - rules[]      \u2502         \u2502  - rules[]      \u2502\n\u2502  - listeners[]  \u2502         \u2502  - listeners[]  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u25b2                           \u25b2\n         \u2502                           \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 GameStateCommand\u2502         \u2502MatchStateCommand\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h2,{id:"game-state-flow",children:"Game State Flow"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"GameStateManager"})," controls the overall application state:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   StartRequested   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Title    \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba \u2502   Running   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                         \u2502\n                                   TogglePause\n                                         \u2502\n                                         \u25bc\n                                   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                   \u2502   Paused    \u2502\n                                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                         \u2502\n                                   TogglePause\n                                         \u2502\n                                         \u25bc\n                                   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                   \u2502   Running   \u2502\n                                   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gamestate-enum",children:"GameState Enum"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"State"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Title"})}),(0,s.jsx)(n.td,{children:"Main menu / title screen"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Running"})}),(0,s.jsx)(n.td,{children:"Game is actively playing"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Paused"})}),(0,s.jsx)(n.td,{children:"Game is paused"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"match-state-flow",children:"Match State Flow"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"MatchStateManager"})," controls the match/round lifecycle within a running game:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   WarmupRequested   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Undefined   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba \u2502    Warmup     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                             \u2502\n                                    PlayerSpawnRequested\n                                             \u2502\n                                             \u25bc\n                                      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                      \u2502  PlayerSpawn  \u2502\n                                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                             \u2502\n                                       StartRequested\n                                             \u2502\n                                             \u25bc\n                                      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                      \u2502    Playing    \u2502\n                                      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.h3,{id:"matchstate-enum",children:"MatchState Enum"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"State"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Undefined"})}),(0,s.jsx)(n.td,{children:"Initial state before match starts"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Warmup"})}),(0,s.jsx)(n.td,{children:"Pre-match preparation phase"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Intro"})}),(0,s.jsx)(n.td,{children:"Introduction/cutscene phase"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Countdown"})}),(0,s.jsx)(n.td,{children:"Countdown before gameplay"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"PlayerSpawn"})}),(0,s.jsx)(n.td,{children:"Player entity spawning"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Playing"})}),(0,s.jsx)(n.td,{children:"Active gameplay"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"transition-rules",children:"Transition Rules"}),"\n",(0,s.jsx)(n.p,{children:"Both managers use transition rules to define valid state changes:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"// GameStateTransitionRule(from, transitionId, to, type)\nGameStateTransitionRule(\n    GameState::Title, \n    GameStateTransitionId::StartRequested, \n    GameState::Running, \n    GameStateTransitionType::Standard\n);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Rules can include guards for conditional transitions:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"GameStateTransitionRule rule{\n    GameState::Running,\n    GameStateTransitionId::TogglePause,\n    GameState::Paused,\n    GameStateTransitionType::Guarded,\n    [](const UpdateContext& ctx) { return canPause(ctx); }\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"listeners",children:"Listeners"}),"\n",(0,s.jsx)(n.p,{children:"Listeners react to state changes and can perform actions like:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Resetting the game world"}),"\n",(0,s.jsx)(n.li,{children:"Spawning the player"}),"\n",(0,s.jsx)(n.li,{children:"Showing/hiding UI elements"}),"\n",(0,s.jsx)(n.li,{children:"Playing audio cues"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"class WorldResetListener : public GameStateTransitionListener {\npublic:\n    void onGameStateEnter(UpdateContext& ctx, GameState state) override {\n        if (state == GameState::Running) {\n            ctx.gameWorld().reset();\n        }\n    }\n};\n\n// Register with manager\ngameStateManager->addGameStateListener(std::make_unique<WorldResetListener>());\n"})}),"\n",(0,s.jsx)(n.h2,{id:"usage-example",children:"Usage Example"}),"\n",(0,s.jsx)(n.h3,{id:"configuring-state-managers",children:"Configuring State Managers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"// Create managers\nauto gameStateManager = std::make_unique<GameStateManager>();\nauto matchStateManager = std::make_unique<MatchStateManager>();\n\n// Add listeners\ngameStateManager->addGameStateListener(std::make_unique<WorldResetListener>());\nmatchStateManager->addMatchStateListener(std::make_unique<PlayerSpawnListener>(player));\n\n// Register with GameWorld\ngameWorld.addManager(std::move(gameStateManager));\ngameWorld.addManager(std::move(matchStateManager));\n"})}),"\n",(0,s.jsx)(n.h3,{id:"requesting-state-transitions",children:"Requesting State Transitions"}),"\n",(0,s.jsx)(n.p,{children:"State transitions are requested via commands:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"// Request game start\ncommandBuffer.add<GameStateCommand>(\n    GameStateTransitionRequest(GameState::Title, GameStateTransitionId::StartRequested)\n);\n\n// Request player spawn in match\ncommandBuffer.add<MatchStateCommand>(\n    MatchStateTransitionRequest(MatchState::Warmup, MatchStateTransitionId::PlayerSpawnRequested)\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"querying-current-state",children:"Querying Current State"}),"\n",(0,s.jsx)(n.p,{children:"Access the current state through the Session:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"auto& session = gameWorld.session();\n\nGameState gameState = session.gameState();\nMatchState matchState = session.matchState();\n\nif (gameState == GameState::Running && matchState == MatchState::Playing) {\n    // Game is actively playing\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"pass-level-state-filtering",children:"Pass-Level State Filtering"}),"\n",(0,s.jsx)(n.p,{children:"Passes in the game loop can be configured to run only during specific game states:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"// This pass only runs when game is Running\ngameLoop.phase(PhaseType::Main)\n    .addPass(GameState::Running)\n        .addSystem<MovementSystem>()\n        .addSystem<CollisionSystem>();\n\n// This pass runs in all states\ngameLoop.phase(PhaseType::Pre)\n    .addPass(GameState::Any)\n        .addSystem<InputSystem>();\n"})}),"\n",(0,s.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/core-concepts/gameloop-architecture",children:"Game Loop Architecture"})," \u2014 Phase/Pass structure"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/core-concepts/command-system",children:"Command System"})," \u2014 Command-driven state changes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/core-concepts/event-system",children:"Event System"})," \u2014 Event propagation"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);